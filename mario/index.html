<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>放物線</title>
  </head>
	<BODY style="width:100%; overflow:hidden;background:url(bg.png) repeat;padding:0px;margin:0px;">
		<div id="divM" style="width:64px;height:64px;position:absolute;overflow:hidden;" />
			<img id="mario" src="mario.gif" style="position:relative;" />
		</div>
		<div id="ground" style="width:100%;position:absolute;height:128px;bottom:0px;background:url(ground.png) repeat;" /></div>
		<div id="sky" style="width:100%;position:absolute;height:300px;top:0px;background:url(sky.png) repeat;" /></div>
<!--
		<input type=image id="btn" src="b1.png" style="position:absolute;width:128px;height:64px;bottom:10px;left:10px;background:#ccc;border-left:2px solid #eee;border-top:2px solid #eee;border-right:3px solid #999;border-bottom:3px solid #999;"> 
-->
		<input type=button id="btn" style="position:absolute;width:132px;height:68px;bottom:10px;left: 10px;margin:0px;padding:0px;background:#ccc url(b1.png)" onclick="bodyClick(0);" > 
		<input type=button id="btn" style="position:absolute;width:132px;height:68px;bottom:10px;left:152px;margin:0px;padding:0px;background:#ccc url(b2.png)" onclick="bodyClick(1);" > 
	</BODY>

<script>
	var mX = 0;
	var mY0 = window.innerHeight - 64 * 3;
	var mY = mY0;
	var mCount = 1;
	var mJump = false;
	var mJmode = 0;
	var mV = 0.0;
	var mV0 = -400.0;
	var mG = 800.0;

	var timer = function() {
		//------------------------------------------------------------------
		// 横位置
		//------------------------------------------------------------------
		document.getElementById("divM").style.left = mX;

		mX += 45;

		if (mX >= window.innerWidth) {
			mX -= window.innerWidth;
		}

		//------------------------------------------------------------------
		// 縦位置
		//------------------------------------------------------------------
		if (mJump) {
			// 放物線
			if (mJmode == 0) {
				mY = mY + mV * 0.2 + 0.5 * mG * 0.2 * 0.1;
				mV = mV + mG * 0.2;
				if (mY > mY0) {
					mY = mY0;
					mJump = false;
				}
			}
			// ジグザグ
			else if (mJmode == 1) {
				if ((mY < mY0-128) && (mV < 0)) {
						mV *= -1;
				}
				mY = mY + mV/10;
				if (mY > mY0) {
					mY = mY0;
					mJump = false;
				}
			}
		}
		document.getElementById("divM").style.top = mY;

alert(mX + ' ' + mY);
		//------------------------------------------------------------------
		// アニメ
		//------------------------------------------------------------------
		if (mJump) {
			document.getElementById("mario").style.top = -128;
			document.getElementById("mario").style.left = -8;
		}
		else {
			document.getElementById("mario").style.top = -64;
			document.getElementById("mario").style.left = ((mCount-1) * 64 + 3)*-1;
		}

		mCount++;
		if (mCount > 6) {
			mCount = 1;
		}
		//------------------------------------------------------------------
		setTimeout(timer, 200);
	}

	function bodyClick(mode) {
		if (!mJump) {
			mJump = true;
			mV = mV0;
			mJmode = mode;
		}
	}
	timer();

</script>
</html>
